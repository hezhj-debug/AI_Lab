import{bn as A,a_ as le,l as H,S as j,b as z,a7 as N,aH as ce,_ as q,d as R,u as ae,r as S,q as ie,e as G,aF as ue,w,o as K,p as fe,x as C,y as E,A as Q,B as W,M as pe,G as T,g as v,L as $,aK as X,Q as de,k as he,a2 as me,P as ve,U as ke,V as ge}from"./index-B7NibMAT.js";import{r as Y,c as x,C as ye}from"./raf-Bfg2FQbx.js";function Se(t,n,r,o){const f=r-n;return t/=o/2,t<1?f/2*t*t*t+n:f/2*((t-=2)*t*t+2)+n}function Te(t,n,r,o,f){const p=Date.now();let u;const h=()=>{const c=Date.now()-p,m=Se(c>o?o:c,n,r,o);A(t)?t.scrollTo(window.pageXOffset,m):t.scrollTop=m,c<o?u=Y(h):le(f)&&f()};return h(),()=>{u&&x(u)}}const F=(t,n)=>A(n)?t.ownerDocument.documentElement:n,I=t=>A(t)?window.scrollY:t.scrollTop,U=t=>{let n=0,r=t;for(;r;)n+=r.offsetTop,r=r.offsetParent;return n},V=(t,n)=>Math.abs(U(t)-U(n)),_e=z({container:{type:N([String,Object])},offset:{type:Number,default:0},bound:{type:Number,default:15},duration:{type:Number,default:300},marker:{type:Boolean,default:!0},type:{type:N(String),default:"default"},direction:{type:N(String),default:"vertical"},selectScrollTop:Boolean}),we={change:t=>H(t),click:(t,n)=>t instanceof MouseEvent&&(H(n)||j(n))},J=Symbol("anchor"),_=t=>{if(!ce||t==="")return null;if(H(t))try{return document.querySelector(t)}catch{return null}return t};function Ce(t){let n=0;const r=(...o)=>{n&&x(n),n=Y(()=>{t(...o),n=0})};return r.cancel=()=>{x(n),n=0},r}const Ee=R({name:"ElAnchor"}),Ae=R({...Ee,props:_e,emits:we,setup(t,{expose:n,emit:r}){const o=t,f=ae(),p=S(""),u=S({}),h=S(null),k=S(null),c=S(),m={};let s=!1,g=0;const y=ie("anchor"),ee=G(()=>[y.b(),o.type==="underline"?y.m("underline"):"",y.m(o.direction)]),te=e=>{m[e.href]=e.el},ne=e=>{delete m[e]},M=e=>{p.value!==e&&(p.value=e,r(ye,e))};let b=null;const oe=e=>{if(!c.value)return;const l=_(e);if(!l)return;b&&b(),s=!0;const a=F(l,c.value),i=V(l,a),d=a.scrollHeight-a.clientHeight,B=Math.min(i-o.offset,d);b=Te(c.value,g,B,o.duration,()=>{setTimeout(()=>{s=!1},20)})},L=e=>{e&&(M(e),oe(e))},se=(e,l)=>{r("click",e,l),L(l)},O=Ce(()=>{c.value&&(g=I(c.value));const e=re();s||j(e)||M(e)}),re=()=>{if(!c.value)return;const e=I(c.value),l=[];for(const a of Object.keys(m)){const i=_(a);if(!i)continue;const d=F(i,c.value),B=V(i,d);l.push({top:B-o.offset-o.bound,href:a})}l.sort((a,i)=>a.top-i.top);for(let a=0;a<l.length;a++){const i=l[a],d=l[a+1];if(a===0&&e===0)return o.selectScrollTop?i.href:"";if(i.top<=e&&(!d||d.top>e))return i.href}},P=()=>{const e=_(o.container);!e||A(e)?c.value=window:c.value=e};ue(c,"scroll",O);const D=()=>{X(()=>{if(!h.value||!k.value||!p.value){u.value={};return}const e=m[p.value];if(!e){u.value={};return}const l=h.value.getBoundingClientRect(),a=k.value.getBoundingClientRect(),i=e.getBoundingClientRect();if(o.direction==="horizontal"){const d=i.left-l.left;u.value={left:`${d}px`,width:`${i.width}px`,opacity:1}}else{const d=i.top-l.top+(i.height-a.height)/2;u.value={top:`${d}px`,opacity:1}}})};return w(p,D),w(()=>{var e;return(e=f.default)==null?void 0:e.call(f)},D),K(()=>{P();const e=decodeURIComponent(window.location.hash);_(e)?L(e):O()}),w(()=>o.container,()=>{P()}),fe(J,{ns:y,direction:o.direction,currentAnchor:p,addLink:te,removeLink:ne,handleClick:se}),n({scrollTo:L}),(e,l)=>(E(),C("div",{ref_key:"anchorRef",ref:h,class:T(v(ee))},[e.marker?(E(),C("div",{key:0,ref_key:"markerRef",ref:k,class:T(v(y).e("marker")),style:pe(u.value)},null,6)):Q("v-if",!0),W("div",{class:T(v(y).e("list"))},[$(e.$slots,"default")],2)],2))}});var Re=q(Ae,[["__file","anchor.vue"]]);const be=z({title:String,href:String}),Le=R({name:"ElAnchorLink"}),Be=R({...Le,props:be,setup(t){const n=t,r=S(null),{ns:o,direction:f,currentAnchor:p,addLink:u,removeLink:h,handleClick:k}=de(J),c=G(()=>[o.e("link"),o.is("active",p.value===n.href)]),m=s=>{k(s,n.href)};return w(()=>n.href,(s,g)=>{X(()=>{g&&h(g),s&&u({href:s,el:r.value})})}),K(()=>{const{href:s}=n;s&&u({href:s,el:r.value})}),he(()=>{const{href:s}=n;s&&h(s)}),(s,g)=>(E(),C("div",{class:T(v(o).e("item"))},[W("a",{ref_key:"linkRef",ref:r,class:T(v(c)),href:s.href,onClick:m},[$(s.$slots,"default",{},()=>[me(ve(s.title),1)])],10,["href"]),s.$slots["sub-link"]&&v(f)==="vertical"?(E(),C("div",{key:0,class:T(v(o).e("list"))},[$(s.$slots,"sub-link")],2)):Q("v-if",!0)],2))}});var Z=q(Be,[["__file","anchor-link.vue"]]);const $e=ke(Re,{AnchorLink:Z}),xe=ge(Z);export{$e as E,xe as a};
